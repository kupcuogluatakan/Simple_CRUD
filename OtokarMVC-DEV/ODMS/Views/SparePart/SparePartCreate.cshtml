@using ODMSCommon.Resources
@model ODMSModel.SparePart.SparePartIndexViewModel
@{
    ViewBag.Title = CommonUtility.GetResourceValue("SparePart_PageTitle_Create");
    Layout = "~/Views/Shared/Popup_Layout.cshtml";
}

 
@using (Html.BeginForm("SparePartCreate", "SparePart", FormMethod.Post))
{
    <div class="labelDiv">@Html.LabelFor(v => v.OriginalPartName)</div>
    <div class="shortTxtDiv">
        @{
    Html.RenderAction("AutocompleteSearch", "AutocompleteSearch", new { Required = true, SearchType = "OrginalSparePart", ControlId = "OriginalPartId", Title1 = "", Title2 = "", DefaultText = Model.OriginalPartName, DefaultValue = Model.OriginalPartId, CallbackFunction = "GetSparePartData" });
        }@Html.ValidationMessageFor(v => v.OriginalPartId)
    </div>
    <div class="clearDiv">&nbsp;</div>
    <div class="labelDiv">@Html.LabelFor(v => v.PartCode)</div>
    <div class="shortTxtDiv">@Html.TextBoxFor(v => v.PartCode) @Html.ValidationMessageFor(v => v.PartCode) </div>

    <div class="labelDiv">@Html.LabelFor(v => v.PartName)</div>
    <div id="divName">
        <div class="shortTxtDiv">
            @{ Html.RenderAction("MultiLanguageTextbox", "MultiLanguage",
                                        new { DefaultText = Model.MultiLanguageContentAsText, IsEnabled = true }); }
            @Html.ValidationMessageFor(v => v.MultiLanguageContentAsText)

        </div>
    </div>
    <div class="clearDiv">&nbsp;</div>
    <div class="labelDiv">@Html.LabelFor(v => v.Barcode)</div>
    <div class="shortTxtDiv">@Html.TextBoxFor(v => v.Barcode)</div>               
@* TFS NO : 29729 OYA                                
               if (!ODMSCommon.Security.UserManager.UserInfo.IsDealer)
               {
    <div class="labelDiv">@Html.LabelFor(v => v.PartTypeName)</div>
    <div class="shortTxtDiv">@Html.Kendo().ComboBoxFor(v => v.PartTypeCode).DataTextField("Text").DataValueField("Value").BindTo(ViewBag.SparePartTypeList as List<SelectListItem>).Placeholder(CommonUtility.GetResourceValue("Global_Display_Choose")).HtmlAttributes(new { @style = "width:200px;" })
        @Html.ValidationMessageFor(v => v.PartTypeCode)
    </div>
               }*@
    <div class="clearDiv">&nbsp;</div>

    <div class="labelDiv">@Html.LabelFor(v => v.Brand)</div>
    <div class="shortTxtDiv">@Html.TextBoxFor(v => v.Brand) @Html.ValidationMessageFor(v => v.Brand)</div>

    <div class="labelDiv">@Html.LabelFor(v => v.DealerName)</div>
    <div class="shortTxtDiv">@Html.Kendo().ComboBoxFor(v => v.DealerId).DataTextField("Text").DataValueField("Value").BindTo(ViewBag.DealersList as List<SelectListItem>).Placeholder(CommonUtility.GetResourceValue("Global_Display_Choose")) @Html.ValidationMessageFor(v => v.DealerId)</div>

    <div class="clearDiv">&nbsp;</div>
               if (!ODMSCommon.Security.UserManager.UserInfo.IsDealer)
               {
    <div class="labelDiv">@Html.LabelFor(v => v.NSN)</div>
    <div class="shortTxtDiv">@Html.TextBoxFor(v => v.NSN) @Html.ValidationMessageFor(v => v.NSN)</div>
    <div class="clearDiv">&nbsp;</div>
               }
    <div class="labelDiv">@Html.LabelFor(v => v.ShipQuantity)</div>
    <div class="shortTxtDiv">@Html.Kendo().NumericTextBoxFor(c => c.ShipQuantity).Decimals(2).Format("{0:N}").HtmlAttributes(new { type = "text", maxlength = "6", data_val_min = "0", style = "width:200px" }).Spinners(false)
        @Html.ValidationMessageFor(v => v.ShipQuantity)
    </div>
    <div class="labelDiv">@Html.LabelFor(v => v.UnitName)</div>
    <div class="shortTxtDiv">@Html.Kendo().ComboBoxFor(v => v.Unit).DataTextField("Text").DataValueField("Value").BindTo(ViewBag.UnitsList as List<SelectListItem>).Placeholder(CommonUtility.GetResourceValue("Global_Display_Choose")) @Html.ValidationMessageFor(v => v.Unit)</div>
    <div class="clearDiv">&nbsp;</div>
    <div class="labelDiv">@Html.LabelFor(v => v.AdminDesc)</div>
    <div class="shortTxtDiv">@Html.TextBoxFor(v => v.AdminDesc) @Html.ValidationMessageFor(v => v.AdminDesc) </div>  
    <div class="labelDiv">@Html.LabelFor(v => v.Volume)</div>
    <div class="shortTxtDiv">
        @Html.Kendo().NumericTextBoxFor(c => c.Volume).Format("#.00 cm").Spinners(false).HtmlAttributes(new { type = "text", maxlength = "6", style = "width:204px" })
        @Html.ValidationMessageFor(v => v.Volume)
    </div>
    <div class="clearDiv">&nbsp;</div>
    <div class="labelDiv">@Html.LabelFor(v => v.Weight)</div>
    <div class="shortTxtDiv">
        @Html.Kendo().NumericTextBoxFor(c => c.Weight).Format("#.00 kg").Spinners(false).HtmlAttributes(new { type = "text", maxlength = "7", style = "width:204px" })
        @Html.ValidationMessageFor(v => v.Weight)
    </div> 

    <div class="labelDiv">@Html.LabelFor(c => c.IsOrderAllowed)</div>
    <div class="shortTxtDiv">@Html.Kendo().ComboBoxFor(v => v.IsOrderAllowed).DataTextField("Text").DataValueField("Value").BindTo(ViewBag.YesNoBooleanList as List<SelectListItem>).Placeholder(CommonUtility.GetResourceValue("Global_Display_Choose")) @Html.ValidationMessageFor(v => v.IsOrderAllowed)</div>
    
    <div class="clearDiv">&nbsp;</div>
    <div class="labelDiv">@Html.LabelFor(c => c.IsActiveName)</div>
    <div class="shortTxtDiv">@Html.CheckBoxFor(v => v.IsActive)  </div>

    <div class="labelDiv">@Html.LabelFor(c => c.LeadTime)</div>
    <div class="shortTxtDiv">
        @Html.Kendo().NumericTextBoxFor(v => v.LeadTime).Min(1).Max(9999).Decimals(0).Spinners(false).HtmlAttributes(new { @style = "width:204px;" })
        @Html.ValidationMessageFor(v => v.LeadTime)
    </div>
    <div class="clearDiv">&nbsp;</div>
    <div class="labelDiv">@Html.LabelFor(v => v.VatRatio)</div>
    <div class="shortTxtDiv">@Html.Kendo().ComboBoxFor(c => c.VatRatio).BindTo(ViewBag.VatRatioList as List<SelectListItem>).DataValueField("Value").DataTextField("Text").Placeholder(CommonUtility.GetResourceValue("Global_Display_Choose")) </div>
      
    <div class="clearDiv">&nbsp;</div>
    <div class="labelDiv">@Html.LabelFor(v => v.GuaranteeAuthorityNeed)</div>
    <div class="shortTxtDiv" style="font-weight: bold; font-size:13px;" id="lblGuaranteeAuthorityNeed">
    </div>

    <div class="labelDiv">@Html.LabelFor(v => v.CompatibleGuaranteeUsage, MessageResource.SparePart_Display_CompatibleGuaranteeUsage)</div>
    <div class="labelDiv" style="padding-left:15px; font-weight: bold; font-size:13px;" id="lblCompatibleGuaranteeUsage"></div>

    <div class="clearDiv">&nbsp;</div>

    @Html.HiddenFor(c => c.DealerId)
    @Html.HiddenFor(v => v.PartCode)
    @ODMSHelpers.Button("Create", CommonUtility.GetResourceValue("Global_Display_Save"), CommonValues.PermissionCodes.SparePart.SparePartCreate, "SparePartCreate")        
}
<script type="text/javascript">

    $(function () {
        $('.k-widget').addClass('input-validation-valid');
        $(".k-widget").removeClass("input-validation-error");
    });
    function GetSparePartData() {
        $.post("@Url.Action("GetSparePart", "SparePart")", {
            partId: $("#OriginalPartId").val(),
            dealerId: $("#DealerId").val(),
            processId:0
        }, function (json) {
            if (json) {
                $("#PartCode").val(json.SubPartCode);
                $("#Barcode").val(json.Barcode);
                $("#MultiLanguageContentAsText").val(json.PartName);
                $("#lblGuaranteeAuthorityNeed").html(json.GuaranteeAuthorityNeedName);
                $("#lblCompatibleGuaranteeUsage").html(json.CompatibleGuaranteeUsageName);
                $.ajax({
                    url: '@Url.Action("MultiLanguageTextbox", "MultiLanguage")',
                    dataType: 'html',
                    data: { DefaultText: json.PartName, DefaultValue: json.PartName, IsEnabled: true },
                    traditional: true,
                    type: 'POST',
                    success: function (content) {
                        $("#divName").html(content);
                    }
                });
            }
        }, "JSON");
    }
    $(document).ready(function () {
        $("#PartCode").attr("readonly", "readonly");
        //$("#Barcode").attr("readonly", "readonly");
        if ($('#OriginalPartId').val() == 0) {
            @*
            Oyaya istinaden Taner
            if ('@ODMSCommon.Security.UserManager.UserInfo.IsDealer' == 'False') {
                //$("#PartTypeCode").data("kendoComboBox").text('');
            }*@

            $("#Unit").data("kendoComboBox").text('');
            $("#IsOrderAllowed").data("kendoComboBox").text('');

        }
        $("#DealerId").data("kendoComboBox").enable(false);

        $('form').each(function () {
            var validator = $(this).data('validator');
            if (validator && validator.settings) {
                validator.settings.ignore = "";
            }
        });
    });
</script>
