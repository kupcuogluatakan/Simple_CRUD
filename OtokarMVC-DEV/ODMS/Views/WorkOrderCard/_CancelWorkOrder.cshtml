@using ODMSCommon.Resources
@model ODMSModel.WorkOrderCard.WorkOrderCancelModel
@{
    Layout = null;// "~/Views/Shared/Popup_Layout.cshtml";
}
<div id="warning-wrap" class="alert alert-warning">
    <strong>@MessageResource.WorkOrderCard_Display_CancelWorkOrderMessage</strong>
</div>
<div id="cancelWo-window" style="margin-top: 20px;">
    @using (Html.BeginForm("CancelWorkOrder", "WorkOrder", FormMethod.Post, new { id = "frmCancel" }))
    {
        @Html.HiddenFor(c => c.WorkOrderId)
        @Html.HiddenFor(c => c.VehicleId)
        <div class="col-sm-2 labelDiv">
            @MessageResource.WorkOrderCard_Display_CancelReason
        </div>
        <div class="col-sm-1 shortTxtDiv">
            @Html.TextAreaFor(c => c.CancelReason)
            @Html.ValidationMessageFor(c => c.CancelReason)
        </div>
        <div class="clearfix"></div>
    }
    <div class="text-right" style="margin-right:30px; margin-top:10px">
        @ODMSHelpers.Button("Cancel", CommonUtility.GetResourceValue("Global_Display_Cancel"), CommonValues.PermissionCodes.WorkOrderCard.WorkOrderCardUpdate, "", "CancelWorkOrder();")
    </div>


</div>
<script type="text/javascript">
    function CancelWorkOrder() {
        if ($('#frmCancel').valid() == false) return;
        mvc.build("@Url.Action("CancelWorkOrder", "WorkOrder")", null, null, { CancelReason: $("#CancelReason").val(), WorkOrderId: $("#WorkOrderId").val(), VehicleId: $("#VehicleId").val() }, true, "json");
        mvc.post(null, function(json) {
            console.log(json);
            if (json.Result == false) {
                $("#warning-wrap").removeClass("alert-success").removeClass("alert-warning").addClass("alert-danger");
                $("#warning-wrap  strong").html(json.Message);
            } else {
                $("#warning-wrap").removeClass("alert-warning").removeClass("alert-danger").addClass("alert-success");
                $("#warning-wrap  strong").html(json.Message);
            }
            $('#cancelWo-window').html('');
        }, null);
    }
</script>