@using ODMSCommon.Resources
@model ODMSModel.PDIGOSApproveGroupVehicleModels.PDIGOSApproveGroupVehicleModelsModel

@{
    ViewBag.Title = MessageResource.PDIGOSApproveGroupVehicleModels_PageTitle_Index;
}
 
@Html.AntiForgeryToken()
@if (ViewBag.GroupId > 0)
{
    <script type="text/x-kendo-tmpl" id="ModelItemTemplate">
    <div class="ListItemText" style="padding:3px 0 0 5px; cursor:default">
        <span data-modelkod=#:Value#>#:Text#</span>
    </div>
</script>
    <script type="text/javascript">
        $(document).ready(function() {
            $('#btnAddGAGM').click(AddModelHandler);
            $('#btnAddAllGAGM').click(AddModelAllHandler);
            $('#btnRemoveGAGM').click(RemoveModelHandler);
            $('#btnRemoveAllGAGM').click(RemoveModelAllHandler);
            $('#btnSaveGAGM').click(SaveModelsHandler);
        });

        function GetGroupDetails() {
            $("#lstModelsNotIncludedInPDIGOSApproveGroupVehicleModels").data("kendoListView").dataSource.read();
            $("#lstModelsIncludedInPDIGOSApproveGroupVehicleModels").data("kendoListView").dataSource.read();
        }

        function GetData() {
            return {
                groupId:  @ViewBag.GroupId
            };
        }


        function AddModelHandler() {
            $(".k-state-selected", "#lstModelsNotIncludedInPDIGOSApproveGroupVehicleModels").each(function(i, e) {
                $("#lstModelsIncludedInPDIGOSApproveGroupVehicleModels").append($(e).clone()).html();
                $(e).remove();
            });
        }

        function AddModelAllHandler() {
            $(".ListItemText", "#lstModelsNotIncludedInPDIGOSApproveGroupVehicleModels").each(function(i, e) {
                $("#lstModelsIncludedInPDIGOSApproveGroupVehicleModels").append($(e).clone()).html();
                $(e).remove();
            });
        }

        function RemoveModelHandler() {
            $(".k-state-selected", "#lstModelsIncludedInPDIGOSApproveGroupVehicleModels").each(function(i, e) {
                $("#lstModelsNotIncludedInPDIGOSApproveGroupVehicleModels").append($(e).clone()).html();
                $(e).remove();
            });
        }

        function RemoveModelAllHandler() {
            $(".ListItemText", "#lstModelsIncludedInPDIGOSApproveGroupVehicleModels").each(function(i, e) {
                $("#lstModelsNotIncludedInPDIGOSApproveGroupVehicleModels").append($(e).clone()).html();
                $(e).remove();
            });
        }

        function SaveModelsHandler() {
            var includedModelKods = [];
            $("#lstModelsIncludedInPDIGOSApproveGroupVehicleModels").children().each(function(i, e) {
                var modelKod = $("span", e).data("modelkod");
                includedModelKods[i] = modelKod;
            });
            var token = $('input[name="__RequestVerificationToken"]').val();

            $.ajax({
                type: "POST",
                url: "@Url.Action("Save", "PDIGOSApproveGroupVehicleModels")",
                data: { GroupId: @ViewBag.GroupId, ModelList: includedModelKods, "__RequestVerificationToken": token },
                traditional: true,
                success: function(result) {
                    if (result.Result == false)
                        SetErrorMessage(result.Message);
                    else
                        SetSuccessMessage(result.Message);
                },
                dataType: "json"
            });
        }
    </script>

    <div id="roles-wrapper" style="width: 700px; margin-left: 30px;">
        <div style="float: left; width: 280px;">
            <h4>
                @MessageResource.PDIGOSApproveGroupVehicleModels_Display_VehicleModelsExcluded
            </h4>
            @(Html.Kendo().ListView<SelectListItem>()
                  .Name("lstModelsNotIncludedInPDIGOSApproveGroupVehicleModels")
                  .Selectable(v => v.Mode(ListViewSelectionMode.Multiple))
                  .ClientTemplateId("ModelItemTemplate")
                  .TagName("div")
                  .DataSource(ds => ds.Read(read =>
                                            read.Action("ListModelsExcluded", "PDIGOSApproveGroupVehicleModels").Data("GetData")))
                  .HtmlAttributes(new {@style = "height:200px; overflow:auto;"})
                  )
        </div>
        <div style="float: left; width: 140px; margin-top: 40px;">
            <div style="text-align: center; margin-top: 10px;">
                @ODMSHelpers.LinkButton("btnAddGAGM", "&rsaquo;", "", "arrow-btn", "", "")
            </div>
            <div style="text-align: center; margin-top: 10px;">
                @ODMSHelpers.LinkButton("btnRemoveGAGM", "&lsaquo;", "", "arrow-btn", "", "")
            </div>
            <div style="text-align: center; margin-top: 10px;">
                @ODMSHelpers.LinkButton("btnAddAllGAGM", "&raquo;", "", "arrow-btn", "", "")
            </div>
            <div style="text-align: center; margin-top: 10px;">
                @ODMSHelpers.LinkButton("btnRemoveAllGAGM", "&laquo;", "", "arrow-btn", "", "")
            </div>
        </div>

        <div style="float: left; width: 280px">
            <h4>
                @MessageResource.PDIGOSApproveGroupVehicleModels_Display_VehicleModelsIncluded
            </h4>
            @(Html.Kendo().ListView<SelectListItem>()
                  .Name("lstModelsIncludedInPDIGOSApproveGroupVehicleModels")
                  .Selectable(v => v.Mode(ListViewSelectionMode.Multiple))
                  .ClientTemplateId("ModelItemTemplate")
                  .TagName("div")
                  .HtmlAttributes(new {@style = "height:200px; overflow:auto;"})
                  .DataSource(ds => ds.Read(read =>
                                            read.Action("ListModelsIncluded", "PDIGOSApproveGroupVehicleModels").Data("GetData"))))
        </div>

        <div class="clearfix" style="margin-bottom: 15px;"></div>
        @ODMSHelpers.LinkButton("btnSaveGAGM", MessageResource.Global_Display_Save, "", "", "", "")
    </div>
}